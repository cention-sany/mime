package quotedprintable

import (
	"io/ioutil"
	"strings"
	"testing"
)

var tstData1 = []struct {
	in, out string
}{
	{ //1
		in:  "=C3=83=C2=B6rfr=C3=83=C2=A5",
		out: "=C3=83=C2=B6rfr=C3=83=C2=A5"},
	{ //2
		in:  "class=3D\"\">Ringv\xc3\r\n\xa4gen 14, ",
		out: "class=3D\"\">Ringv\xc3\xa4gen 14, "},
	{ //3
		in:  "\xC3\x85\xC3\x84\xC3\x96. \xC3\xA5\xC3\xA4\r\n\xC3\xB6.",
		out: "\xC3\x85\xC3\x84\xC3\x96. \xC3\xA5\xC3\xA4\r\n\xC3\xB6."},
	{ //4
		in:  "ara kostnad f\xC3\n\x83\xC2\xB6r order 768298",
		out: "ara kostnad f\xC3\x83\xC2\xB6r order 768298"},
	{ //5
		in:  "fru Susanne och jag \xC3\r\n\xB6nskar ",
		out: "fru Susanne och jag \xC3\xB6nskar "},
	{ //6
		in:  "language:EN-US\">Bra fr\xC3\n\xA5ga som jag",
		out: "language:EN-US\">Bra fr\xC3\xA5ga som jag"},
	{ //7
		in:  "language:EN-US\">Bra fr\xC3\n\n\xA5ga som jag",
		out: "language:EN-US\">Bra fr\xC3\n\n\xA5ga som jag"},
	{ //8
		in:  "lang你\r\n好uage:EN-US\">test 刘\r健\n胜123",
		out: "lang你\r\n好uage:EN-US\">test 刘\r健\n胜123"},
	{ //9
		in:  "lang \r\rå\n\n, ä, ö\r\n好uage:EN-US\">test 刘\r å, ä\r, \nö\n胜123",
		out: "lang \r\rå\n\n, ä, ö\r\n好uage:EN-US\">test 刘\r å, ä\r, \nö\n胜123"},
	{ //10
		in:  "lang你\r\n好uage:EN-US\">test \xF0\x9F\r\xA4\x90 (f09fa490)123",
		out: "lang你\r\n好uage:EN-US\">test \xF0\x9F\r\xA4\x90 (f09fa490)123"},
	{ //11
		in:  "lang你\r\n好uage:EN-US\">test \xF0\n\x9F\xA4\x90 (f09fa490)123",
		out: "lang你\r\n好uage:EN-US\">test 🤐 (f09fa490)123"},
	{ //12
		in: `	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	A
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	B
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	C
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	E
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789🤐`,
		out: `	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	A
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	B
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	C
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	E
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789
	23456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789🤐`},
}

func Test_qpUTF8(t *testing.T) {
	for i, d := range tstData1 {
		r := newQPUTF8(strings.NewReader(d.in))
		b, err := ioutil.ReadAll(r)
		if err != nil {
			t.Fatalf("[%d] FAILED expected nil error but got %v", i+1, err)
		}
		out := string(b)
		if out != d.out {
			t.Errorf("[%d] FAILED expected: %s but got %s", i+1, d.out, out)
		}
	}
}
